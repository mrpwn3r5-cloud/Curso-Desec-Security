
## 0. Credenciais Padrão

### 0.1 Teste de Credenciais Padrão
```bash
# Sempre testar credenciais default, ou tentar buscar credenciais default daquele serviço específico na internet
admin:admin
ftp:ftp
anonymous:anonymous
root:root
administrator:administrator
guest:guest
```

## 1. Enumeração SMB/NetBIOS

Responsável pelo compartilhamento de arquivos na rede
> NetBIOS: 139 TCP
> SMB: 445 TCP

**Ver exemplos de brute force:** [[03.03 - Brute Force e Quebra de Senhas#5. Brute Force SMB]]

### 1.1 Enumeração Básica
```bash
# Verificar se SMB está rodando
nmap -p 139,445 TARGET_IP

# Enumeração com smbclient
smbclient -L \\TARGET_IP -N

# Enumeração com usuário específico
smbclient -L \\TARGET_IP -U administrator

# Exemplo específico do curso
smbclient -L \\172.16.1.4 -N --option='client min protocol=NT1'

# Utilizando o smbclient para listar os compartilhamentos de uma maquina
smbclient -L \\IPALVO
# poderia usar o -N para não fornecer a senha ou dar enter quando pedir a senha para tentar um null session

# passando um usuario
smbclient -L \\IPALVO -N -U administrator

# quando o login é em um domínio (servidor AD) precisa passar o dominio
smbclient -L \\IPALVO -U fulano -W dominio

# Interagindo com um compartilhamento - atentar para barras invertidas e sem o -L
# passando o diretorio que quer se conectar
smbclient //IPALVO/nomepasta -N
help
ls

# Resolvendo problemas de conexões quando usamos o smbclient mais atualizado do que a versão do serviço utilizado no servidor, passando um option
smbclient -L \\172.16.1.4 -N --option='client min protocol=NT1'
```

### 1.2 Enumeração com Enum4linux
```bash
# Enumeração completa
enum4linux -a TARGET_IP

# Enumeração com credenciais
enum4linux -a TARGET_IP -u administrator -p password

# Enumeração específica
enum4linux -U TARGET_IP  # Usuários
enum4linux -G TARGET_IP  # Grupos
enum4linux -S TARGET_IP  # Compartilhamentos

# Exemplo específico do curso
enum4linux -a IPALVO
enum4linux -a IPALVO -u administrator -p
```

### 1.3 Enumeração com Nbtscan
```bash
# Pode-se usar o nbtscan para scannear toda a rede por serviços NetBIOS e SMB
nbtscan -r 172.16.1.0/24
```

### 1.4 Enumeração com RPCClient
```bash
# Conexão RPC
rpcclient -U "" -N TARGET_IP

# Comandos úteis dentro do rpcclient
enumdomusers
enumdomgroups
querydominfo
netshareenumall
queryuser username
querygroup 0x200

# Exemplo específico do curso
rpcclient -U "" -N 172.16.1.4 --option='client min protocol=NT1'
```

### 1.5 Enumeração com CrackMapExec / netexec
```bash
# Enumeração de hosts SMB
crackmapexec smb TARGET_IP

# Teste de credenciais
crackmapexec smb TARGET_IP -u username -p password

# Enumeração de domínio
crackmapexec smb TARGET_IP -u username -p password -d domain

# Exemplo específico do curso
crackmapexec smb hosts.txt
crackmapexec smb hosts.txt -u fulano -p senha -d dominio
# se retornar Pwned é pq consegue executar comandos
```

### 1.6 Enumeração NetBIOS com Windows
```cmd
# Exibe todas as maquinas que já conectou e estatísticas do protocolo, e informações de maquinas e seus grupos
nbtstat -c
nbtstat -A IPALVO

# Exibindo sessões ativas
net use

# Exibindo compartilhamentos das maquinas
net view \\IPALVO

# Estabelecendo uma sessão com null session
net use \\IPALVO "" /u:""
net use \\IPALVO "" /u:administrator

# Interagindo com um compartilhamento, atribuindo uma letra para o compartilhamento
net use h: \\IPALVO\nomepasta
h:

# Removendo compartilhamento e sessão da maquina
net use h: /delete
net use \\IPALVO /delete
```

### 1.7 Scripts Nmap para SMB
```bash
# Scripts básicos
nmap --script=smb-os-discovery TARGET_IP
nmap --script=smb-enum-shares TARGET_IP
nmap --script=smb-enum-users TARGET_IP

# Scripts de vulnerabilidade
nmap --script=smb-vuln-* TARGET_IP

# Exemplo específico do curso
sudo nmap -v -p 139 172.16.1.4 --script smb-os-discovery
```

## 2. Enumeração SSH

> Porta 22 TCP

**Ver exemplos de brute force:** [[03.03 - Brute Force e Quebra de Senhas#2. Brute Force SSH]]

### 2.1 Enumeração Básica
```bash
# Verificar banner SSH
nc -v TARGET_IP 22

# Enumeração com nmap
nmap -p 22 --script=ssh-hostkey TARGET_IP
nmap -p 22 --script=ssh-auth-methods TARGET_IP
```

### 2.2 Enumeração de Chaves SSH
```bash
# Verificar chaves públicas
ssh-keyscan TARGET_IP

# Verificar chaves com nmap
nmap --script=ssh-hostkey TARGET_IP

# Verificar os tipos de autenticação aceitas no SSH
ssh -v TARGET_IP
```

## 3. Enumeração FTP

> Porta 21 TCP

**Ver exemplos de brute force:** [[03.03 - Brute Force e Quebra de Senhas#4. Brute Force FTP]]

### 3.1 Enumeração Básica
```bash
# sempre testar credenciais default
# Conexão FTP
nc -v TARGET_IP 21
>
USER ftp
PASS ftp
QUIT
<

# Conexão com cliente FTP
ftp TARGET_IP

# habilitar modo passivo para poder interagir

# Enumeração com nmap
nmap -p 21 --script=ftp-anon TARGET_IP
nmap -p 21 --script=ftp-bounce TARGET_IP
```

### 3.2 Teste de Login Anônimo
```bash
# Login anônimo
ftp TARGET_IP
# Username: anonymous / ftp
# Password: anonymous / ftp

# Verificar permissões
ls -la
pwd

# Exemplo específico do curso
# 1) Conectar com o serviço usando nc ou o próprio cliente ftp para detectar banner.
# 2) Testar logins padrões de anonymous e senha anonymous ou ftp e senha ftp
# 3) Em alguns casos será necessário ativar o modo passivo com `passive`
```

### 3.3 Enumeração com NcFTP
```bash
# Instalação
sudo apt install ncftp

# Conexão
ncftp TARGET_IP
```

## 4. Enumeração [[02.01 - Enumeração Web Completa|HTTP/HTTPS]]

> Porta 80 TCP (HTTP)
> Porta 443 TCP (HTTPS)
> Porta 8080 TCP (HTTP alternativa)

## 5. Enumeração DNS

> Porta 53 UDP
> Porta 53 TCP (transferência de zona)

### 5.1 Enumeração Básica
```bash
# Consultas DNS básicas
dig @TARGET_IP domain.com
nslookup domain.com TARGET_IP

# Enumeração de DNS 
host -t PTR IPHOST
host -t TXT IPHOST
host -t NS IPHOST
host -t CNAME IPHOST
host -t A IPHOST
host -t AAAA IPHOST
host -t SOA IPHOST
host -t MX IPHOST
host -t HINFO IPHOST

# Verificar transferência de zona
dig axfr domain.com @TARGET_IP
```

Usando transferência de zona:
```bash
host -l -a besoft.com.br ns1.hostinger.com.br
``` 

DNS reverso com o comando host:
```bash
host 177.22.223.22
```


### 5.2 Enumeração com Dnsrecon
```bash
# Instalação
sudo apt install dnsrecon

# Enumeração básica
dnsrecon -d domain.com -t std

# Enumeração de subdomínios
dnsrecon -d domain.com -t brt
```

### 5.3 Enumeração com Fierce
```bash
# Instalação
sudo apt install fierce

# Enumeração
fierce -dns domain.com
```

## 6. Enumeração SMTP

> Porta 25 TCP
> Porta 587 TCP (SMTP submission)
> Porta 465 TCP (SMTPS)

**Ver exemplos de brute force:** [[03.03 - Brute Force e Quebra de Senhas#9. Brute Force SMTP]]

### 6.1 Enumeração Básica
```bash
# Conexão SMTP
nc -v TARGET_IP 25

# Enumeração com nmap
nmap -p 25 --script=smtp-enum-users TARGET_IP
nmap -p 25 --script=smtp-commands TARGET_IP
```

### 6.2 Enumeração de Usuários
```bash
# Conexão SMTP
nc -v TARGET_IP 25

# Comandos SMTP
HELO test
EHLO test
VRFY root
VRFY admin
VRFY administrator
EXPN root
HELP

# Exemplo específico do curso
nc -vn 172.30.0.128 25
HELO jean
EHLO jean
VRFY root
VRFY jean
HELP

# Outra forma de enumerar usuários é tentar enviar um e-mail
mail from: pentester
rcpt to: usuario
DATA
mensagem para fulano
.
```

### 6.3 Enumeração com SmtpUserEnum
```bash
# Instalação
sudo apt install smtp-user-enum

# Enumeração
smtp-user-enum -M VRFY -U /usr/share/wordlists/metasploit/unix_users.txt -t TARGET_IP
```

## 7. Enumeração POP3

> Porta 110 TCP
> Porta 995 TCP (POP3S)

**Ver exemplos de brute force:** [[03.03 - Brute Force e Quebra de Senhas#10. Brute Force POP3]]

### 7.1 Enumeração Básica
```bash
# Conexão POP3
nc -v TARGET_IP 110

# Enumeração com nmap
nmap -p 110 --script=pop3-capabilities TARGET_IP
```

### 7.2 Teste de Login
```bash
# Conexão POP3
nc -v TARGET_IP 110

# Comandos POP3
USER username
PASS password
STAT
LIST
RETR 1
QUIT

# Exemplo específico do curso
nc -v mail.businesscorp.com.br 110
USER camila
PASS ca123456
STAT
LIST
RETR 1
RETR 2
```

## 8. Enumeração IMAP

> Porta 143 TCP
> Porta 993 TCP (IMAPS)

**Ver exemplos de brute force:** [[03.03 - Brute Force e Quebra de Senhas#11. Brute Force IMAP]]

### 8.1 Enumeração Básica
```bash
# Conexão IMAP
nc -v TARGET_IP 143

# Enumeração com nmap
nmap -p 143 --script=imap-capabilities TARGET_IP
```

### 8.2 Teste de Login
```bash
# Conexão IMAP
nc -v TARGET_IP 143

# Comandos IMAP
A001 LOGIN username password
A002 LIST "" *
A003 SELECT INBOX
A004 FETCH 1 ALL
A005 LOGOUT
```

## 9. Enumeração SNMP

> Porta 161 UDP
> Porta 162 UDP (SNMP Trap)

### 9.1 Enumeração Básica
```bash
# Verificar SNMP
nmap -p 161 -sU -sC TARGET_IP

# Enumeração com snmpwalk
snmpwalk -c public -v1 TARGET_IP
```

### 9.2 Enumeração de Communities
```bash
# Sites: www.oid-info.com
# wordlists:
/usr/share/seclists/Discovery/SNMP/snmp-onesixtyone.txt
/usr/share/wordlists/seclists/Discovery/SNMP/common-snmp-community-strings.txt

# Enumeração com onesixtyone
onesixtyone -c /usr/share/wordlists/seclists/Discovery/SNMP/common-snmp-community-strings.txt TARGET_IP

# Teste manual
snmpwalk -c public -v1 TARGET_IP
snmpwalk -c private -v1 TARGET_IP
snmpwalk -c manager -v1 TARGET_IP

# Exemplo específico do curso
nano comu.txt
# Adicionar:
# public
# private
# manager
# cisco
# access
# secrete
# juniper
onesixtyone -c comu.txt 172.16.1.0/24
```

### 9.3 Enumeração com SnmpCheck
```bash
# Instalação
sudo apt install snmp-check

# Enumeração
snmp-check TARGET_IP -c public

# Exemplo específico do curso
apt install snmp-mibs-downloader
echo "" > /etc/snmp/snmp.conf
snmptranslate -TB icmp
snmptranslate -Td IP-MIB::icmpInEchos

# visualização completa de todos os dados
snmpwalk -c public -v1 TARGET_IP
snmpwalk -c public -v1 TARGET_IP 1.3.6.1.4.1.77.1.2.25
snmpwalk -c public -v1 TARGET_IP IP-MIB::icmpInEchos
snmp-check TARGET_IP -c public

# Alterando valores no SNMP quando temos uma communitie com permissão de escrita
snmpset -c manager -v1 TARGET_IP SNMPv2-MIB::sysContact.0 s "JEAN"
```

## 10. Enumeração MySQL

> Porta 3306 TCP

**Ver exemplos de brute force:** [[03.03 - Brute Force e Quebra de Senhas#7. Brute Force MySQL]]

### 10.1 Enumeração Básica
```bash
# Verificar MySQL
nmap -p 3306 --script=mysql-info TARGET_IP

# Conexão MySQL
mysql -h TARGET_IP -u root
mysql -h TARGET_IP -u mysql
```

### 10.2 Teste de Login
```bash
# Tentativas de login
mysql -h TARGET_IP -u root -p
mysql -h TARGET_IP -u admin -p
mysql -h TARGET_IP -u mysql -p

# Exemplo específico do curso
mysql -h TARGET_IP -u mysql
mysql -h TARGET_IP -u root
show databases;
use bancodedados;
```

### 10.3 Enumeração com Nmap
```bash
# Scripts MySQL
nmap -p 3306 --script=mysql-enum TARGET_IP
nmap -p 3306 --script=mysql-users TARGET_IP
nmap -p 3306 --script=mysql-databases TARGET_IP
```

### 10.3 Dump do Mysql
```bash
# 1. EXECUTAR QUERY E SALVAR RESULTADO
mysql -u username -p -e "SELECT * FROM users;" database_name > users_dump.txt

# 2. DUMP DE TABELA EM FORMATO CSV
mysql -u username -p -e "SELECT * FROM users INTO OUTFILE '/tmp/users.csv' FIELDS TERMINATED BY ',' ENCLOSED BY '\"' LINES TERMINATED BY '\n';" database_name

# 3. EXECUTAR MÚLTIPLAS QUERIES
mysql -u username -p database_name -e "SELECT * FROM users; SELECT * FROM products;" > multiple_queries.txt

# 4. DUMP EM FORMATO HTML
mysql -u username -p --html -e "SELECT * FROM users;" database_name > users.html

# 5. DUMP EM FORMATO XML
mysql -u username -p --xml -e "SELECT * FROM users;" database_name > users.xml

# 6. DUMP COM BATCH MODE (sem formatação)
mysql -u username -p --batch -e "SELECT * FROM users;" database_name > users_raw.txt

# 7. LISTAR TODAS AS DATABASES
mysql -u root -p -e "SHOW DATABASES;" > databases_list.txt

# 8. LISTAR TODAS AS TABELAS DE UM BANCO
mysql -u username -p -e "SHOW TABLES;" database_name > tables_list.txt

# 9. DUMP DA ESTRUTURA DE UMA TABELA
mysql -u username -p -e "DESCRIBE users;" database_name > users_structure.txt

# ou

mysql -u username -p -e "SHOW CREATE TABLE users;" database_name > users_create.sql

# 10. DUMP DE DADOS ESPECÍFICOS COM WHERE
mysql -u username -p -e "SELECT * FROM users WHERE role='admin';" database_name > admin_users.txt
```

## 11. Enumeração PostgreSQL

> Porta 5432 TCP

**Ver exemplos de brute force:** [[03.03 - Brute Force e Quebra de Senhas#8. Brute Force PostgreSQL]]

### 11.1 Enumeração Básica
```bash
# Verificar PostgreSQL
nmap -p 5432 --script=pgsql-info TARGET_IP

# Conexão PostgreSQL
psql -h TARGET_IP -U postgres
```

### 11.2 Teste de Login
```bash
# Tentativas de login
psql -h TARGET_IP -U postgres -W
psql -h TARGET_IP -U admin -W
```

### 11.3 Enumeração com Nmap
```bash
# Scripts PostgreSQL
nmap -p 5432 --script=pgsql-enum TARGET_IP
nmap -p 5432 --script=pgsql-users TARGET_IP
```

## 12. Enumeração RDP

> Porta 3389 TCP

**Ver exemplos de brute force:** [[03.03 - Brute Force e Quebra de Senhas#6. Brute Force RDP]]

### 12.1 Enumeração Básica
```bash
# Verificar RDP
nmap -p 3389 --script=rdp-enum-encryption TARGET_IP

# Conexão RDP
rdesktop TARGET_IP
```

### 12.2 Enumeração com Nmap
```bash
# Scripts RDP
nmap -p 3389 --script=rdp-enum-encryption TARGET_IP
nmap -p 3389 --script=rdp-vuln-ms12-020 TARGET_IP
```

## 13. Enumeração LDAP

> Porta 389 TCP (LDAP)
> Porta 636 TCP (LDAPS)

**Ver exemplos de brute force:** [[03.03 - Brute Force e Quebra de Senhas#12. Brute Force LDAP]]

### 13.1 Enumeração Básica
```bash
# Verificar LDAP
nmap -p 389,636 --script=ldap-rootdse TARGET_IP

# Conexão LDAP
ldapsearch -H ldap://TARGET_IP -x -s base
```

### 13.2 Enumeração com Nmap
```bash
# Scripts LDAP
nmap -p 389 --script=ldap-search TARGET_IP
nmap -p 389 --script=ldap-brute TARGET_IP
```

## 14. Enumeração NFS

> Porta 2049 TCP

### 14.1 Enumeração Básica
```bash
# Verificar NFS
nmap -p 2049 --script=nfs-showmount TARGET_IP

# Verificar compartilhamentos
showmount -e TARGET_IP
```

### 14.2 Montagem de Compartilhamentos
```bash
# Montar compartilhamento
mkdir /tmp/nfs
mount -t nfs TARGET_IP:/share /tmp/nfs

# Desmontar
umount /tmp/nfs

# Exemplo específico do curso
rpcinfo -p 172.16.1.5 | grep nfs
showmount -e 172.16.1.5
mount -t nfs -o nfsvers=2 172.16.1.5:/ /tmp/nfs
umount nfs
```

## 15. Enumeração Telnet

> Porta 23 TCP

**Ver exemplos de brute force:** [[03.03 - Brute Force e Quebra de Senhas#13. Brute Force Telnet]]

### 15.1 Enumeração Básica
```bash
# Conexão Telnet
telnet TARGET_IP 23

# Enumeração com nmap
nmap -p 23 --script=telnet-encryption TARGET_IP
```

## 16. Enumeração VNC

> Porta 5900 TCP

**Ver exemplos de brute force:** [[03.03 - Brute Force e Quebra de Senhas#14. Brute Force VNC]]

### 16.1 Enumeração Básica
```bash
# Verificar VNC
nmap -p 5900 --script=vnc-info TARGET_IP

# Conexão VNC
vncviewer TARGET_IP:5900
```

### 16.2 Enumeração com Nmap
```bash
# Scripts VNC
nmap -p 5900 --script=vnc-info TARGET_IP
nmap -p 5900 --script=vnc-brute TARGET_IP
```

## 17. Enumeração Redis

> Porta 6379 TCP

**Ver exemplos de brute force:** [[03.03 - Brute Force e Quebra de Senhas#15. Brute Force Redis]]

### 17.1 Enumeração Básica
```bash
# Verificar Redis
nmap -p 6379 --script=redis-info TARGET_IP

# Conexão Redis
redis-cli -h TARGET_IP
```

### 17.2 Comandos Redis
```bash
# Comandos básicos
INFO
KEYS *
GET key
```

## 18. Enumeração MongoDB

> Porta 27017 TCP

**Ver exemplos de brute force:** [[03.03 - Brute Force e Quebra de Senhas#16. Brute Force MongoDB]]

### 18.1 Enumeração Básica
```bash
# Verificar MongoDB
nmap -p 27017 --script=mongodb-info TARGET_IP

# Conexão MongoDB
mongo TARGET_IP:27017
```

### 18.2 Comandos MongoDB
```bash
# Comandos básicos
show dbs
use database
show collections
```

## 19. Checklist de Validação

- [ ] SMB/NetBIOS enumerado
- [ ] SSH verificado
- [ ] FTP testado
- [ ] HTTP/HTTPS analisado
- [ ] DNS verificado
- [ ] SMTP enumerado
- [ ] POP3 testado
- [ ] IMAP verificado
- [ ] SNMP enumerado
- [ ] MySQL testado
- [ ] PostgreSQL verificado
- [ ] RDP testado
- [ ] LDAP enumerado
- [ ] NFS verificado
- [ ] Telnet testado
- [ ] VNC verificado
- [ ] Redis testado
- [ ] MongoDB verificado
- [ ] Resultados documentados

## 20. Ferramentas Complementares

### 20.1 Nmap Scripts
```bash
# Listar scripts disponíveis
nmap --script-help all

# Executar scripts por categoria
nmap --script=auth TARGET_IP
nmap --script=discovery TARGET_IP
nmap --script=vuln TARGET_IP
```

### 20.2 Metasploit Auxiliaries
```bash
# Dentro do msfconsole
use auxiliary/scanner/smb/smb_version
use auxiliary/scanner/ssh/ssh_version
use auxiliary/scanner/ftp/ftp_version
```

## 21. Dicas Importantes

1. **Sempre verificar banners** dos serviços
2. **Testar credenciais padrão** primeiro
3. **Usar rate limiting** para evitar bloqueios
4. **Documentar versões** dos serviços encontrados
5. **Verificar vulnerabilidades** conhecidas
6. **Salvar resultados** de todas as enumerações
7. **Priorizar serviços** baseado no objetivo
8. **Validar descobertas** com múltiplas ferramentas
